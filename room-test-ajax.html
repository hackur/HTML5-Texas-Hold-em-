<html>
<head>
<script src="./static/jquery.min.js"></script>
</head>
<body>
<input name="username" type="text"/>
<button id="enter-btn">enter</button>
<input name="message" type="text"/>
<button id="message-btn">post</button>
</body>
<script>
$(document).ready(function(){
	$('#enter-btn').click(function(){
		var username = $('input[name="username"]').val();
		$.post(
			"./enter",
			{room_id:1, username:username},
			function(data){
				console.log(data);
				if(data.status=='success'){
					listenBoardMessage();
				}
			},
			'json'
		);
	});
	$('#message-btn').click(function(){
		var message = $('input[name="message"]').val();
		postBoardMessage(message);
	});
});
function listenBoardMessage(){
	$.ajax({
		type:'post',
		url:"./listen-board-message",
		data:{offset:1},
		timeout:5000,
		success:function(data){
			console.log("listen board message reply success")
			console.log(data);
			listenBoardMessage();
		},
		error: function(XMLHttpRequest, textStatus, errorThrown) {
			console.log("listen board message reply error")
			console.log(textStatus);
			listenBoardMessage();
		},
		dataTye:'json',
	});
}

function postBoardMessage(message){
	$.ajax({
		type:'post',
		url:"./sit-down",
		data:{seat:message, offset:1},
		success:function(data){
			console.log(data);
		},
		dataTye:'json',
	});
}
</script>
</html>
